/*! wsu-spine 1.0.0 2014-08-18 */
/*  See https://github.com/washingtonstateuniversity/WSU-spine/ for full source.*/
function dump(a,b,c){var d,e,f,g,h;for(d="",b||(b=3),c||(c=0),e="",f=0;c+1>f;f++)e+="	";if("object"==typeof a){if(b>=c)for(g in a)h=a[g],"object"==typeof h?(d+=e+"'"+g+"' ...\n",d+=dump(h,b,c+1)):d+=e+"'"+g+"' => \""+h+'"\n'}else d="===>"+a+"<===("+typeof a+")";return d}!function(a){"use strict";a.widget("ui.autosearch",a.ui.autocomplete,{_renderMenu:function(b,c){var d=this,e=c.filter(function(a,b){return"false"!==a.related?b:void 0});a.each(c.filter(function(a,b){return"false"===a.related?b:void 0}),function(a,c){d._renderItemData(b,c)}),this.options.showRelated&&e.length&&(this.options.relatedHeader&&d._renderHeader(b,this.options.relatedHeader),a.each(e,function(a,c){d._renderItemData(b,c)}))},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){var d=c.label;return a("<li></li>").data("item.autocomplete",c).append(d).appendTo(b)},_renderHeader:function(b,c){return a("<li></li>").append("<a href=''>"+c+"</a>").appendTo(b)}})}(jQuery),function(a,b,c,d){a.fn.stripClass=function(a,b){var c;return c=new RegExp((b?"\\S+":"\\b")+a+"\\S*","g"),this.attr("class",function(a,b){return b?b.replace(c,""):void 0}),this},a.fn.refresh=function(){var b;b=a(this.selector),this.splice(0,this.length);try{this.push.apply(this,b)}catch(c){return a(""!==a(this.selector).html()?this.selector:"<div>")}return this},a.runTemplate=function(a,b){var c,d,e,f,g,h,i;for(c=/<%(.+?)%>/g,h=/(^( )?(var|if|for|else|switch|case|break|{|}|;))(.*)?/g,g="var r=[];\n",f=0,d=function(a,b){return g+=b?a.match(h)?a+"\n":"r.push("+a+");\n":""!==a?"r.push('"+a.replace(/'/g,'"')+"');\n":"",d};e=c.exec(a);)d(a.slice(f,e.index))(e[1],!0),f=e.index+e[0].length;return d(a.substr(f,a.length-f)),g=(g+"return r.join('');").replace(/[\r\t\n]/g,""),i=new Function(g).apply(b)},a.whenAll=function(){return a.when.apply(a,arguments)},a.s=function(b,c){var e;e=b.split(".")[0],b=b.split(".")[1],a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._setup(a,b)},a[e][b].prototype=a.extend({namespace:e,pluginName:b},c),a.fn[b]=function(c){var f,g,h,i;return g={},arguments[1]&&(g=arguments[1]),c=c||{},this.options=a.extend({},c),f="string"==typeof c,h=Array.prototype.slice.call(arguments,1),i=this,f&&"_"===c.substring(0,1)?i:(this.each(function(){var j;j=a.data(this,b),j||(j=a.data(this,b,new a[e][b](c,this))),j[c+"_init"]!==d&&j[c+"_init"]&&j[c+"_init"](g),f&&j[c]!==d&&(i=j[c].apply(j,h))}),i)}},a.s("ui.spine",{globals:{version:"0.1.0",current_url:b.location.href},options:{},_setup:function(b,c){this.el=c,b=b||{},a.extend(this.options,b,{}),this._create()},_create:function(){var a;a=this,this.instance={spine:a.options,framework:[],search:[],social:[],analytics:[]},a._call(a.options.callback,a.instance.spine)},_set_globals:function(b,c){c=c||"","object"==typeof b&&a.extend(this.globals,b)},_get_globals:function(a){return this.globals[a]},clear:function(a){return this._c(this.get(a)),this.set(a,[]),this},_c:function(a){for(var b in a)a.hasOwnProperty(b)&&(a[b]=null)},find:function(b,c,d){var e,f,g,h;e=this.get(b),c.value=a.isArray(c.value)?c.value:[c.value];for(g in e)if(e.hasOwnProperty(g)){f=!1;for(h in c.value)if(a.inArray(c.value[h],e[g][c.property])>-1)f=!0;else if(c.operator&&"AND"===c.operator){f=!1;break}d(e[g],f)}return this},get:function(a,b){var c,d,e;if(c=this.instance,!c[a]){if(a.indexOf(">")>-1){for(d=a.replace(/ /g,"").split(">"),e=0;e<d.length;e++){if(!c[d[e]]){if(!b)return null;c[d[e]]=e+1<d.length?[]:b}c=c[d[e]]}return c}b&&!c[a]&&this.set(a,b)}return c[a]},set:function(a,b){return this.instance[a]=b,this},_unwrap:function(b){return b?b instanceof jQuery?b[0]:b instanceof Object?b:a("#"+b)[0]:null},_call:function(b){b&&a.isFunction(b)&&b.apply(this,Array.prototype.slice.call(arguments,1))},clear_spine:function(){this.clear("search").clear("framework").clear("social").clear("analytics")},destroy:function(b){this.clear("search").clear("framework").clear("social").clear("analytics")._c(this.instance),a.removeData(this.el,this.name),this._call(b,this)}}),a.spine=function(b){var c;return c=this.jquery===d?a("body"):this,a.each(c,function(){var c;c=a(this),c.spine({}),b=a.extend({framework:{},search:{},social:{},analytics:{}},b),a.each(b,function(a,b){c.spine(a,b)})})}}(jQuery,window,document),function(a){a.extend(a.ui.spine.prototype,{framework_init:function(b){a.extend(this.framework_options,b),this._set_globals(this.framework_globals),this.framework_create()},framework_options:{equalizer_filter:".skip*",contact_template:" <address itemscope itemtype='http://schema.org/Organization' class='hcard'> 									<% if (typeof(this.department) != 'undefined') { %><div class='organization-unit fn org'>										<% if (typeof(this.url) != 'undefined') { %><a href='<%this.url%>' class='url'><% } %> 											<%this.department%> 										<% if (typeof(this.url) != 'undefined') { %></a><% } %> 									</div><% } %> 									<% if (typeof(this.name) != 'undefined') { %><div class='organization-name'><%this.name%></div><% } %> 									<div class='address'> 										<% if (typeof(this.streetAddress) != 'undefined') { %><div class='street-address'><%this.streetAddress%></div><% } %> 										<% if (typeof(this.addressLocality) != 'undefined' || typeof(this.postalCode) != 'undefined') { %><div class='locality'> 											<% if (typeof(this.addressLocality) != 'undefined' ) { %><%this.addressLocality%><% } %> <% if (typeof(this.addressRegion) != 'undefined' ) { %>, <%this.addressRegion%><% } %> 											<% if (typeof(this.postalCode) != 'undefined' ) { %><span class='postalcode'><%this.postalCode%></span><% } %> 										</div><% } %> 									</div> 									<% if (typeof(this.telephone) != 'undefined' ) { %><div class='tel'><%this.telephone%></div><% } %> 									<% if (typeof(this.email) != 'undefined' ) { %><div class='email' rel='email'><a href='mailto:<%this.email%>'>Email us</a></div><% } %> 										 									<% if (typeof(this.ContactPoint) != 'undefined' && typeof(this.ContactPointTitle) != 'undefined') { %> 										<div class='more'><a href='<%this.ContactPoint%>'><%this.ContactPointTitle%></a></div> 									<% } %> 								</address>"},framework_globals:{spine:a("#spine"),glue:a("#glue"),main:a("main"),wsu_actions:a("#wsu-actions")},framework_create:function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p={};b=this,m=b._get_globals("spine").refresh(),n=b._get_globals("glue").refresh(),o=b._get_globals("main").refresh(),a("#wsu-contact").length||(c="<section id='wsu-contact' class='spine-contact spine-action closed'>",p={},a.each(a("[itemtype='http://schema.org/Organization']"),function(){var d=this;a.each(a(d).find("[itemprop]"),function(b,c){var d={};d[a(c).attr("itemprop")]=a(c).attr("content"),a.extend(p,d)}),c+=a.runTemplate(b.framework_options.contact_template,p)}),c+="</section>",b.setup_tabs("contact",c)),k=a(".lt-ie9 img[src$='.svg']"),k.lenght&&a.each(k,function(){a(this).attr("src",a(this).attr("src").replace(".svg",".png"))}),b.setup_nav(),b.setup_nav_scroll(),b.setup_spine(),b.setup_printing(),a(window).on("resize",function(){b.sizing(),b.equalizing(),b.mainheight(),(a(".unbound").length||a("#binder.broken").length)&&(d=a(window).width(),e=b._get_globals("main").offset().left,f=b._get_globals("main").width(),h=d-b._get_globals("main").offset().left,i="",i=h>=f?h-f:0,a("#binder").hasClass("broken")&&b._get_globals("main").css("width",h),j=e+b._get_globals("main").width(),a(".unbound:not(.element).recto").css("width",h).css("margin-right",-i),a(".unbound.element.recto").each(function(){g=a(this).width(),a(this).css("width",g+i).css("margin-right",-i)}),a(".unbound.verso").css("width",j).css("margin-left",-e),a(".unbound.verso.recto").css("width",d)),a(".cropped").length<=0,l=a(window).height(),n.css("min-height",l),m.css("min-height",l),a(".spine-header").height()>50&&m.removeClass("unshelved"),a(document).trigger("scroll")}).trigger("resize")},sizing:function(b){var c,d;b=b||a("#jacket"),c=a(window).width(),d="",c>=1188?d="size-xlarge size-gt-small size-gt-smallish size-gt-medium size-gt-large":c>=990?d="size-large size-lt-xlarge size-gt-small size-gt-smallish size-gt-medium":990>c&&c>=792?d="size-medium size-lt-xlarge size-lt-large size-gt-smallish size-gt-small":c>=694&&792>c&&a("#binder").hasClass("fixed")?d="size-smallish size-lt-medium size-lt-large size-lt-xlarge size-gt-small":792>c?d="size-small size-lt-smallish size-lt-medium size-lt-large size-lt-xlarge":396>c&&(d="size-small size-lt-small size-lt-smallish size-lt-medium size-lt-large size-lt-xlarge"),b.stripClass("size-").addClass(d)},equalizing:function(){var b;a(".equalize").length&&(b=a(".row.equalize"),b.find(".column").css("min-height",""),a.each(b,function(){var b=0;a.each(a(".column",this),function(){b=a(this).outerHeight()>b?a(this).outerHeight():b}),a(window).width()<=792?a(".column",this).not(".unequaled").css("min-height","1"):a(".column",this).not(".unequaled").css("min-height",b),a("section.equalize .column",this).css("min-height","auto")}))},mainheight:function(){var b,c,d,e;b=this._get_globals("main").refresh(),b.offset()&&(c=b.offset().top,d=a(window).height(),e=d,a("#binder").hasClass("size-lt-large")&&(e-=50),a("main:not(.height-auto)").css("min-height",e))},setup_jacket:function(){},setup_binder:function(){},setup_content:function(){},setup_spine:function(){var b,c,d,e,f,g,h,i,j,k,l;g=0,h=0,f=0,b=this,c=b._get_globals("spine").refresh(),d=b._get_globals("glue").refresh(),e=b._get_globals("main").refresh(),a(".cropped").length<=0,a(document).on("scroll touchmove",function(){var b,m;b=a(document).scrollTop(),m=a(document).height()-a(window).height()-a(window).scrollTop(),g=f-b,f=b,i=a(window).height(),j=c[0].scrollHeight,k=d.height(),l=i-j,e.height()>k&&((g>0?1:0)?(h=h>=0?0:h+g,b>0&&h>0&&(h=0)):(h=l>=h?l:h+g,0>=m&&h>=l&&(h=l)),0>=b&&(h=0),0>=m&&(h=l),c.css({position:"fixed",top:h+"px"}))}),a(document).keydown(function(b){(35===b.which||36===b.which)&&(i=a(window).height(),j=c[0].scrollHeight,l=i-j,35===b.which?h=l:36===b.which&&(h=0),c.css({position:"fixed",top:h+"px"}))}),a("#glue > header").append("<button id='shelve' />"),a("#shelve").on("click",function(a){a.preventDefault(),c.toggleClass("unshelved shelved")}),e.on("click swipeleft",function(){c.hasClass("unshelved")&&c.toggleClass("shelved unshelved")}),a(document).scroll(function(){var b;b=a(document).scrollTop(),b>148?a("#spine").addClass("skimmed"):a("#spine").removeClass("skimmed")})},setup_tabs:function(b,c){var d,e,f;c=c||"",d=this,e=d._get_globals("wsu_actions").refresh(),e.append(c),a("#wsu-"+b+"-tab button").on("click",function(c){c.preventDefault(),e.find("*.opened,#wsu-"+b+",#wsu-"+b+"-tab").toggleClass("opened closed"),f=a("main").outerHeight()-(a(".spine-header").outerHeight()+a(".wsu-actions-tabs").outerHeight()),a(".spine-action.opened").css("min-height",f)})},setup_nav_scroll:function(){a("#glue").wrapInner("<div id='scroll'>"),a("#spine header").insertBefore(a("#scroll"))},setup_nav:function(){a("#spine nav ul,#spine ul").parents("li").addClass("parent"),a("#spine nav li[class*=current], nav li[class*=active]").addClass("active").parents("li").addClass("active"),a("#spine nav li a[class*=current], nav li a[class*=active]").parents("li").addClass("active"),a("#spine .active").not(":has(.active)").addClass("dogeared"),a("#spine nav li.parent > a").each(function(){var b,c,d,e;b=a(this),c=b.is("[title]")?b.attr("title"):"Overview",c=b.is("[data-overview]")?b.data("overview"):c,c=c.length>0?c:"Overview",d="overview",b.closest(".parent").hasClass("dogeared")&&(d+=" dogeared"),e=b.attr("href"),"#"!==e&&(b.parent("li").children("ul").prepend("<li class='"+d+"'></li>"),b.clone(!0,!0).appendTo(b.parent("li").find("ul .overview:first")),b.parent("li").find("ul .overview:first a").html(c)),b.on("click",function(a){a.preventDefault(),b.parent("li").siblings().removeClass("opened"),b.parent("li").toggleClass("opened")})}),a(".spine-sitenav a").filter(function(){return this.hostname&&this.hostname!==window.location.hostname}).addClass("external")},setup_printing:function(){function b(){window.print()}function c(){a("html").toggleClass("print"),a(".print-controls").remove()}function d(d){void 0!==d&&d.preventDefault(),g.find(".opened").toggleClass("opened closed"),a("html").toggleClass("print"),f.find("header").prepend(h),f.find(".unshelved").removeClass("unshelved").addClass("shelved"),a("#print-invoke").on("click",function(){window.print()}),a("#print-cancel").on("click",c),window.setTimeout(function(){b()},400)}var e,f,g,h;e=this,f=e._get_globals("spine").refresh(),g=e._get_globals("wsu_actions").refresh(),h="<span class='print-controls'><button id='print-invoke'>Print</button><button id='print-cancel'>Cancel</button></span>",a("#wsu-print-tab button").click(d),a("button.shut").on("click",function(a){a.preventDefault(),g.find(".opened").toggleClass("opened closed")})}})}(jQuery),function(a){"use strict";a.extend(a.ui.spine.prototype,{search_init:function(b){var c;c=this,a.extend(b,c.search_options,b),this._set_globals(this.search_globals),this.create_search()},search_options:{data:[],providers:{nav:{name:"From Navigation",nodes:".spine-navigation",dataType:"html",maxRows:12,urlSpaces:"%20"},atoz:{name:"WSU A to Z index",url:"http://search.wsu.edu/2013service/searchservice/search.asmx/AZSearch",urlSpaces:"+",dataType:"jsonp",featureClass:"P",style:"full",maxRows:12,termTemplate:"<strong><%this.term%></strong>",resultTemplate:""}},search:{minLength:2,maxRows:12,getRelated:!0,urlSpaces:"+",tabTemplate:"<section id='wsu-search' class='spine-search spine-action closed'> 								<form id='default-search'> 									<input name='term' type='text' value='' placeholder='search'> 									<button>Submit</button> 								</form> 								<div id='spine-shortcuts' class='spine-shortcuts'></div> 							</section>"},result:{appendTo:"#spine-shortcuts",showRelated:!1,target:"_blank",relatedHeader:"<b class='related_sep'>Related</b><hr/>",providerHeader:"<b class='provider_header'><%this.provider_name%></b><hr/>",termTemplate:"<b><%this.term%></b>",template:"<li><%this.searchitem%></li>"}},search_globals:{wsu_search:a("#wsu-search"),search_input:a("#wsu-search input[type=text]")},create_search:function(){var b,c,d;b=this,c=b._get_globals("wsu_search").refresh(),c.length?(d="<section id='wsu-search' class='spine-search spine-action closed'>"+c.html()+"</section>",c.remove()):d=a.runTemplate(b.search_options.search.tabTemplate,{}),this.setup_tabs("search",d),a("#spine-shortcuts").length<=0&&a("#wsu-search").append("<div id='spine-shortcuts' class='spine-shortcuts'></div>"),a("#wsu-search-tab button").on("click",function(){b._get_globals("search_input").refresh().focus()}),this.setup_search()},start_search:function(b,c){var d,e,f=[];d=this,e=b.term,d.search_options.data=[],a.each(d.search_options.providers,function(b,c){a.ui.autocomplete.prototype.options.termTemplate=void 0!==typeof c.termTemplate&&""!==c.termTemplate?c.termTemplate:void 0,f.push(d.run_query(e,c))}),a.when.apply(a,f).done(function(){a.each(arguments,function(b,c){var f,g;void 0!==c&&(f=c[0],void 0!==f&&f.length>0&&(g=d.setup_result_obj(e,f),a.merge(d.search_options.data,g)))}),d._call(c,d.search_options.data)})},run_query:function(b,c){var d,e=[],f=[];return d=this,e=[],void 0!==typeof c&&void 0!==typeof c.url&&void 0===c.nodes?a.ajax({url:c.url,dataType:c.dataType,data:{featureClass:c.featureClass,style:c.style,maxRows:c.maxRows,name_startsWith:b,related:d.search_options.search.getRelated}}):void 0!==typeof c&&void 0!==typeof c.nodes?(a.each(a(c.nodes).find("a"),function(c,d){var e,g,h;e=a(d),g=e.text(),g.toLowerCase().indexOf(b.toLowerCase())>-1&&(h={label:g,value:e.attr("href")},f.push(h))}),[f]):void 0},format_result_text:function(b,c,d){var e,f,g;return e=this,f="<strong>$1</strong>",g="(?![^&;]+;)(?!<[^<>]*)("+a.ui.autocomplete.escapeRegex(b)+")(?![^<>]*>)(?![^&;]+;)",c="<a href='"+d+"' target='"+e.search_options.result.target+"'>"+c.replace(new RegExp(g,"gi"),f)+"</a>"},setup_result_obj:function(b,c){var d,e;return d=this,e=new RegExp(a.ui.autocomplete.escapeRegex(b),"i"),a.map(c,function(a){var c,f,g;return c=a.label,f=a.value,a.value&&(!b||e.test(c))||"true"===a.related?(c=d.format_result_text(b,c,f),g={label:c,value:a.value,searchKeywords:void 0!==a.searchKeywords?a.searchKeywords:"false",related:void 0!==a.related?a.related:"false"}):void 0})},setup_search:function(){var b,c,d,e={};b=this,c=b._get_globals("wsu_search").refresh(),d=b._get_globals("search_input").refresh(),e={},d.autosearch({appendTo:b.search_options.result.appendTo,showRelated:b.search_options.result.showRelated,relatedHeader:b.search_options.result.relatedHeader,minLength:b.search_options.search.minLength,source:function(a,c){b.start_search(a,function(a){c(a)})},search:function(){e={}},select:function(a,b){var c,e;c=b.item.searchKeywords,e=b.item.label,d.autosearch("close")},focus:function(b,c){d.val(a(c.item.label).text()),e={label:c.item.label},b.preventDefault()},open:function(){},close:function(a){return a.preventDefault(),!1}}).data("autosearch"),d.on("keydown",function(b){b.keyCode===a.ui.keyCode.TAB&&d.is(a(":focus"))&&b.preventDefault(),13===b.which&&d.autosearch("close")}),d.off("click").on("click",function(a){a.stopPropagation(),a.preventDefault()}),a("#wsu-search form").submit(function(){var a,b,e,f,g,h;return a=c.attr("data-default"),b=" site:"+window.location.hostname,"wsu.edu"===a&&(b=""),e="cx=004677039204386950923:xvo7gapmrrg",f="cof=FORID%3A11",g=d.val(),h="http://search.wsu.edu/default.aspx?"+e+"&"+f+"&q="+g+b,window.location.href=h,!1})}})}(jQuery),function(a){a.extend(a.ui.spine.prototype,{social_init:function(b){a.extend(this.social_options,b),this._set_globals(this.social_globals),this.social_create()},social_options:{provider:"WSU_share",script_url:"//repo.wsu.edu/wsu_share/1/",channels:["facebook","twitter","Pintrest"],share_text:"You should know ..."},social_globals:{share_block:a("#wsu-share")},social_create:function(){var a,b,c,d,e,f;a=this,b=a._get_globals("share_block").refresh(),b.length||(c=encodeURIComponent(this.social_options.share_text),d=a._get_globals("current_url"),e=a._get_globals("wsu_actions").refresh(),f="<section id='wsu-share' class='spine-share spine-action closed'> 									<ul> 										<li class='by-facebook'><a href='http://www.facebook.com/sharer/sharer.php?u="+d+"'>Facebook</a></li> 										<li class='by-twitter'><a href='https://twitter.com/intent/tweet?text="+c+"&url="+d+"&via=wsupullman' target='_blank'>Twitter</a></li> 										<li class='by-email'><a href='mailto:?subject="+c+"&body="+d+"'>Email</a></li> 									</ul> 									</section>",a.setup_tabs("share",f))}})}(jQuery),function(a){a.extend(a.ui.spine.prototype,{analytics_init:function(b){var c=this;a.extend(b,c.analytics_options,b)},analytics_options:{google:{analytics:{account_id:"UA-25040747-1",url:"wsu.edu",load_reporule:!1,domainName:!1,cookiePath:!1,trackrule:!1,debug:{run:!1,v_console:!1,console:!0}},verification:"XXXXXXXXXXXXXXXXXXXXX"},bing:{verification:"XXXXXXXXXXXXXXXXXXXXX"}},buildpackage:function(){var b,c;b=this,c={scriptArray:[{src:("https:"===document.location.protocol?"https://":"http://")+"images.wsu.edu/javascripts/jquery.jTrack.0.2.1.js",exc:function(){var c,d,e,f;c=b.analytics_options.google.analytics.load_reporule,d=b.analytics_options.google.analytics.trackrule||{},e="",c!==!1&&(e="loading="+c),(b.analytics_options.google.analytics.trackrule===!1||c!==!1)&&(f=("https:"===document.location.protocol?"https://":"http://")+"images.wsu.edu/javascripts/tracking/configs/pick.asp",a.getJSON(f+"?callback=?"+e,function(b){a.extend(d,b)})),b.run_tracker(d)}}]},a.extend(b.analytics_options,c)},analytics_create:function(){var b,c;b=this,b.buildpackage(),c=b.analytics_options.scriptArray,a.each(c,function(b,c){a.ajax({type:"GET",dataType:"script",cache:!0,url:c.src,success:function(){c.exc()}})})},run_tracker:function(b){var c,d,e;c=this,d=c.analytics_options.google.analytics.domainName,e=c.analytics_options.google.analytics.cookiePath,a.extend(a.jtrack.defaults.debug,c.analytics_options.google.analytics.debug),a.jtrack({load_analytics:{account:c.analytics_options.google.analytics.account_id},options:a.extend({},d!==!1?{domainName:d}:{},e!==!1?{cookiePath:e}:{}),trackevents:b})}})}(jQuery),function(a){"use strict";a(document).ready(function(){a("html").removeClass("no-js").addClass("js");var b=b||{};a.spine(b)})}(jQuery);